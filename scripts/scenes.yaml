sleeping_scene:
  sequence:
    - service: homeassistant.turn_off
      data:
        entity_id:
          - switch.plug_4
          - switch.plug_8
          - switch.plug_3
          - light.bulb_5
    - service: light.turn_on
      data:
        entity_id: 
          - light.bulb_1
          - light.bulb_2
          - light.bulb_3
          - light.bulb_4
        brightness: 1
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {% if is_state('input_boolean.bed_1', 'on') %}
            switch.plug_7
          {% else %}
            input_boolean.bed_1
          {% endif %}
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {% if is_state('input_boolean.bed_2', 'on') %}
            switch.plug_6
          {% else %}
            input_boolean.bed_2
          {% endif %}
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {% if is_state('input_boolean.bed_3', 'on') %}
            switch.plug_5
          {% else %}
            input_boolean.bed_3
          {% endif %}
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {% if is_state('input_boolean.bed_4', 'on') %}
            switch.plug_2
          {% else %}
            input_boolean.bed_4
          {% endif %}
sleeping_away_scene:
  sequence:
    - service: homeassistant.turn_off
      data:
        entity_id:
          - switch.plug_3
          - switch.plug_4
          - light.bulb_5
    - service: light.turn_on
      data:
        entity_id:
          - light.bulb_1
          - light.bulb_2
          - light.bulb_3
          - light.bulb_4
        brightness: 1
    - delay: '{{ "00:%02d:00" % (range(10, 45) | random) }}'
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {{ ['switch.plug_2','switch.plug_5','switch.plug_6','switch.plug_7'] | random }}
    - delay: '{{ "00:%02d:00" % (range(10, 45) | random) }}'
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {{ ['switch.plug_5','switch.plug_6','switch.plug_7'] | random }}
    - delay: '{{ "00:%02d:00" % (range(10, 45) | random) }}'
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {{ ['switch.plug_6','switch.plug_7','switch.plug_8'] | random }}